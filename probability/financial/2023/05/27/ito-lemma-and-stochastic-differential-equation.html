<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Ito Lemma and Stochastic Differential Equation | Jianting Feng</title> <meta name="author" content="Jianting Feng"> <meta name="description" content="A brief introduction to stochastic differential equation and Ito lemma"> <meta name="keywords" content="Statistical Machine Learning"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8F%9D&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jiantingfeng.github.io/probability/financial/2023/05/27/ito-lemma-and-stochastic-differential-equation.html"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jianting </span>Feng</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/code/">Code</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Ito Lemma and Stochastic Differential Equation</h1> <p class="post-meta">May 27, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/category/probability"> <i class="fas fa-tag fa-sm"></i> probability</a>   <a href="/blog/category/financial"> <i class="fas fa-tag fa-sm"></i> financial</a>   </p> </header> <article class="post-content"> <h1 id="martingales-in-discrete-time">Martingales in Discrete Time</h1> <h2 id="conditional-expectation">Conditional expectation</h2> <p>If \(\mathbf X\) is a random variable, then \(\mathbb{E} \mathbf X\) can be thought as the best guess for \(\mathbf X\) given no extra information. A conditional expectation can be viewed as the best guass given certain information.</p> <p>Let \(\mathbf X_1, \mathbf X_2,\cdots\) be a series of random variables. At time \(n\) we have wiewed the first \(n\) values \(\mathbf X_1, \cdots, \mathbf X_n\). If \(\mathbf Y\) is another random variable, then</p> \[\mathbb{E}\left[\mathbf Y\vert \mathbf X_1, \cdots, \mathbf X_n\right]\] <p>can be thought as the best guess given \(\mathbf X_1, \cdots, \mathbf X_n\). \(\mathcal{F}_n\) represents the information contained in \(\mathbf X_1, \cdots, \mathbf X_n\), and \(\mathcal{F}_0\) contains no information. We have following property</p> <ol> <li>If we have no information, then the best guess is the unconditional expectation, \(\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_0\right] = \mathbb{E}\left[\mathbf{Y}\right]\)</li> <li>The conditional exepctation \(\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_n\right]\) should only contain the information up to time \(n\), we say \(\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_n\right]\) is \(\mathcal{F}_n\)-measurable, i.e.</li> </ol> \[\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_n\right] = \varphi(\mathbf{X}_1, \cdots, \mathbf{X}_n)\] <p>A basic property of conditional expectation is that</p> \[\mathbb{E}\left[\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_n\right]\right] = \mathbb{E}\left[\mathbf{Y}\right]\] <p>Besides, conditional expectation is linear, which means, for any \(a, b\in \mathbb{R}\) and random variable \(\mathbf{Y, Z}\), we have</p> \[\mathbb{E}\left[a\mathbf{Y}+b\mathbf{Z}\vert \mathcal{F}_n\right] = a\mathbb{E}\left[\mathbf{Y}\vert \mathcal{F}_n\right] + b\mathbb{E}\left[\mathbf{Z}\vert \mathcal{F}_n\right]\] <h2 id="martingales">Martingales</h2> <p>Martingale is a concept for modeling the fair game. Suppose \(\mathbf{X}_1, \mathbf{X}_2, \cdots\) is a sequence of random variables associated with filtration \(\left\{\mathcal{F}n\right\}\). A sequence of random variables \(\mathbf{M}0, \mathbf{M}1, \cdots\) is called a <em>martingale</em> w.r.t. filtration \(\left\{\mathcal{F}n\right\}\) if:</p> <ol> <li>For each \(n\), \(\mathbf{M}_n\) is \(\mathcal{F}_n\) measurable with \(\mathbb{E}\left[\lvert \mathbf{M}_n\rvert\right]&lt; \infty\)]</li> <li>If \(m &gt; n\), then</li> </ol> \[\mathbb{E}\left[\mathbf{M}_n\vert \mathcal{F}_m\right] = \mathbf{M}_m.\] <p>We can also define a <em>submartingale</em> as</p> \[\mathbb{E}\left[\mathbf{M}_n\vert \mathcal{F}_m\right] \leq \mathbf{M}_m\] <p>and a <em>supermartingale</em></p> \[\mathbb{E}\left[\mathbf{M}_n\vert \mathcal{F}_m\right] \geq \mathbf{M}_m\] <p>Note: For all “fair” games you play in casino, they are always submartingale since you have to pay commission.</p> <h1 id="brownian-motion">Brownian Motion</h1> <h2 id="limits-of-sums-of-independent-variables">Limits of sums of independent variables</h2> <p>Suppose \(\mathbf{X}_1, \mathbf{X}_2,\cdots, \mathbf{X}_n\) are i.i.d. random variables with mean \(\mu\) and variance \(\sigma^2&lt;\infty\). Let</p> \[\mathbf{Z}_n = \dfrac{\left(\mathbf{X}_1 + \cdots + \mathbf{X}_n\right) - n\mu}{\sigma\sqrt{n}}\] <p>Let \(\Phi(b)\) be the c.d.f. of standard Gaussian, i.e.</p> \[\Phi(b) = \int_{-\infty}^b \dfrac{1}{\sqrt{2\pi}} e^{-x^2/2} \mathrm{d} x\] <p>By central limit theorem,</p> \[\lim_{n\to\infty} \mathbb{P}\left[a\leq Z_n\leq b\right] = \Phi(b) - \Phi(a)\] <p>the proof of CLT can be easily derived by the characteristic function.</p> <h2 id="limits-of-random-walks">Limits of random walks</h2> <p>Brownian motion can be viewed as the limit of random walk as the time and space increments tends to zero. Suppose \(\mathbf{X}_1, \mathbf{X}_2, \cdots\) are independent random variables with \(\mathbb{P}\left[\mathbf{X}_j = 1\right] = \mathbb{P}\left[\mathbf{X}_j = -1\right] = \dfrac{1}{2}\) and let</p> \[S_n = X_1 + \cdots + X_n\] <p>here we suppose time and space difference \(\Delta x = 1, \Delta t = 1\). If we choose time increment as \(\Delta t = \dfrac{1}{N}\) where \(N\) is sufficiently large, we view the process at</p> \[\Delta t, 2\Delta t, 3\Delta t, \cdots\] <p>and at each time step we have a jump \(\pm \Delta x\), the value of the process will be</p> \[W_1^{N} = \Delta x\left(X_1 + \cdots + X_N\right)\] <p>we would like to choose \(\text{Var}\left(W_1^N\right) = 1\), i.e.</p> \[\begin{align*} \text{Var}\left(W_1^{N}\right) &amp; = \left(\Delta x\right)\left(\text{Var}X_1 + \cdots + \text{Var}X_N\right) \\ &amp; = \left(\Delta x\right)^2\cdot N = 1 \\ \end{align*}\] <p>we get \(\Delta x = \dfrac{1}{\sqrt{N}}\), note how we choose \(\Delta t\), we deduce that</p> \[\Delta x = \sqrt{\Delta t}\] <h2 id="brownian-motion-1">Brownian Motion</h2> <p><em>Brownian motion</em> or <em>Wiener process</em> is a model of continuous random process. Let \(B_t = B(t)\) be the value at time \(t\), \(B_t\) is a random variable. A collection of random variable indexed by time is called a <em>stochastic process</em>.</p> <p>There are three major assumptions about \(B_t\)</p> <ol> <li> <strong>Stationary increments</strong>. \(s &lt; t\), then the distribution of \(B_t - B_s\) is identical to the distribution of \(B_{t-s}\),</li> <li> <strong>Independent increments</strong>. If \(s &lt; t\), then the random variable \(B_t - B_s\) is independent of \(B_r\) if \(r &lt; s\),</li> <li> <strong>Continuous path</strong>. The function \(t\mapsto B_t\) is continuous (i.e. H"older continuous with exponent equals \(1/ 2\) ).</li> </ol> <p>For convenience, we often set \(B_0 = 0\).</p> <p>A stochastic process \(B_t\) is called (one-dimensional) <em>Brownian motion</em> if it satisfies the following.</p> <ol> <li>\(B_0 = 0\),</li> <li>For \(s &lt; t\), \(B_t - B_s \sim \mathcal{N}\left((t-s)m, (t-s)\sigma^2\right)\) where \(m\) is \textit{drift} and \(\sigma^2\) is <em>variance</em>,</li> <li>If \(s &lt; t\), then \(B_t - B_s\) is independent of \(B_r\) if \(r &lt; s\),</li> <li>With probability \(1\), the function \(t\mapsto B_t\) is continuous.</li> </ol> <p>If \(m = 0\) and \(\sigma^2 = 1\), then \(B_t\) is called <em>standard Brownian motion</em>.</p> <p>Recall the reparameterization trick of standard Gaussian, take \(B_t\) as standard Brownian motion, then</p> \[Y_t = \sigma B_t + mt\] <p>is a Brownian motion with drift \(m\) and variance \(\sigma^2\).</p> <h1 id="ito-integral">Ito Integral</h1> <h2 id="ito-process">Ito Process</h2> <p>Let \(W_t\) denote the standard Brownian motion, we define the <em>Ito process</em> as following</p> <p>Let \(X_t\) be a stochastic process, \(X_t\) is called an <em>Ito process</em> if it satisfies the following stochastic differential equation,</p> \[\mathrm{d} X_t = \underbrace{\mu\left(t, X_t\right) \mathrm{d} t}_{\text{drifting term}} + \underbrace{\sigma\left(t, X_t\right) \mathrm{d} W_t}_{\text{diffusion term}}\] <p>where \(\mu\) and \(\sigma\) are functions of \(t\) and \(X_t\). Remembering the definition of Riemann integral, we can not integrate the stochastic differential equation directly. We need to define a new integral to solve the equation. Which is called \textit{It\^o integral}.</p> <h2 id="ito-integral-1">Ito Integral</h2> <p>Recall the way we solve ordinary differential equation, we can use the following method to solve stochastic differential equation.</p> <p>Let \(f(x, t)\) be a second order differentiable function, we can calculate the Taylor expansion of it as:</p> \[\mathrm{d} f = \dfrac{\partial f}{\partial x} \mathrm{d} x + \dfrac{\partial f}{\partial t} \mathrm{d} t + \dfrac{1}{2} \dfrac{\partial^2 f}{\partial x^2} \mathrm{d} x^2 + \dfrac{1}{2} \dfrac{\partial^2 f}{\partial t^2} \mathrm{d} t^2 + \dfrac{\partial^2 f}{\partial x \partial t} \mathrm{d} x \mathrm{d} t\] <p>substitute \(\mathrm dx\) with \(\mathrm{d}X_t = \mu\left(t, X_t\right) \mathrm{d} t + \sigma\left(t, X_t\right)\mathrm{d}W_t\), recall that \(\left(\mathrm{d}W_t\right)^2 = \mathrm{d}t\) (magic happens here), ignore the high-order term, we get</p> \[\mathrm{d} f = \left(\dfrac{\partial f}{\partial t} + \mu\left(t, X_t\right)\dfrac{\partial f}{\partial x} + \dfrac{\sigma\left(t, X_t\right)^2}{2}\dfrac{\partial^2 f}{\partial x^2}\right) \mathrm{d}t + \sigma\left(t, X_t\right)\dfrac{\partial f}{\partial x} \mathrm{d}W_t\] <p>The equation above is called <em>Ito’s lemma</em> . It is the key to solve stochastic differential equation.</p> <p>Consider \(X_t = W_t^2\), we use Ito’s lemma to calculate \(\mathrm{d}X_t\).</p> \[\begin{align*} \mathrm{d}X_t &amp; = \left(\dfrac{\partial f}{\partial t} + \mu\left(t, X_t\right)\dfrac{\partial f}{\partial x} + \dfrac{\sigma\left(t, X_t\right)^2}{2}\dfrac{\partial^2 f}{\partial x^2}\right) \mathrm{d}t + \sigma\left(t, X_t\right)\dfrac{\partial f}{\partial x} \mathrm{d}W_t \\ &amp; = \left(0 + 0 + \dfrac{1}{2}\cdot 2\cdot 1\right) \mathrm{d}t + 2W_t \mathrm{d}W_t \\ &amp; = \mathrm{d}t + 2W_t \mathrm{d}W_t \end{align*}\] <p>compared to normal differentiation, we have an extra term \(\mathrm{d}t\) term here. On the other hand,</p> \[\int_0^t W_s\mathrm{d}W_s = \dfrac{1}{2}W_t^2 - \dfrac{1}{2}t\] <p>when we reverse the process.</p> <p>This shows we can reverse the process of Ito’s lemma to solve stochastic differential equation.</p> <p>If \(f\) doesn’t contain \(t\), then we can use the following simplyfied form to calculate \(\mathrm{d}f\) (\(\mu=0, \sigma=1\)).</p> \[\mathrm{d}f = f^\prime(X_t) \mathrm{d}X_t + \dfrac{1}{2} \ f^{\prime\prime}(X_t) \mathrm{d}t\] <h3 id="example-geometric-brownian-motion-gbm">Example: Geometric Brownian Motion (GBM)</h3> <p>Geometric Brownian Motion is used to model the stock price. It is defined as</p> \[\mathrm{d}S_t = \mu S_t \mathrm{d}t + \sigma S_t \mathrm{d}W_t\] <p>In order to solve it, take logarithm transformation, i.e. \(\log S_t\), then by It\^o’s lemma,</p> \[\mathrm{d}\log S_t = \dfrac{1}{S_t} \mathrm{d}S_t - \dfrac{1}{2} \dfrac{1}{S_t^2} \mathrm{d}S_t^2 = \left(\mu - \dfrac{1}{2}\sigma^2\right) \mathrm{d}t + \sigma \mathrm{d}W_t\] <p>Integrate both sides, we get the solution</p> \[S_t = S_0 \exp\left(\left(\mu - \dfrac{1}{2}\sigma^2\right)t + \sigma W_t\right)\] <blockquote> <p>The correction term \(\dfrac{1}{2}\sigma^2\) is called \textit{convexity correction}, which comes from the difference between arithmetic mean and geometric mean.</p> </blockquote> <blockquote> <p>We can easily verify whether a process is a martingale by It\^o’s lemma. If the process is a martingale, then the drift term should be zero. For example, \(B_t^2\) is not a martingale, because we have drift term \(- \dfrac{1}{2}\mathrm{d}t\).</p> </blockquote> <p>You can also check whether the following processes are martingales or not, \(W_t\) standards for standard Brownian motion.</p> <ol> <li>\(W_t^3\),</li> <li>\(\dfrac{1}{W_t}\),</li> <li>\(\log W_t\),</li> <li>\(W_t^2 - t\),</li> </ol> <p>All of them are not martingales except the last one.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Jianting Feng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. All contents are under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external nofollow noopener">CC BY-NC-ND 4.0</a>. Last updated: March 06, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-DLKPXN9214"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DLKPXN9214");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>